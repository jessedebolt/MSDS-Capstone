---
title: "Capstone Initial ETL"
author: "Jesse DeBolt"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(tidyverse)
library(viridis)
library(magrittr)
library(readxl)
library(zoo)
```



```{r import}
# Import 2021 "Outcomes & Factors Rankings"
CHR_OR_Out_Fact_Rank_2021 <- read_excel("~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx", sheet = "Outcomes & Factors Rankings")

# Import 2021 "Outcomes & Factors SubRankings"
CHR_OR_Out_Fact_SubRank_2021 <- read_excel("~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx", sheet = "Outcomes & Factors SubRankings")

# Import 2021 "Ranked Measure Data"
CHR_OR_Rank_Meas_Data_2021 <- read_excel("~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx", sheet = "Ranked Measure Data")

# Import 2021 "Additional Measure Data"
CHR_OR_Add_Meas_Data_2021 <- read_excel("~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx", sheet = "Outcomes & Factors Rankings")

```


### Import 2021 "Outcomes & Factors Rankings"
```{r}
# Define the path to the Excel file
path_to_excel <- "~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx"

# Name of the sheet
sheet_name <- "Outcomes & Factors Rankings"

# Read in the first row (0-indexed)
header_row1 <- read_excel(path_to_excel, sheet = sheet_name, range = "A1:G1", col_names = FALSE)

# Read in the second row
header_row2 <- read_excel(path_to_excel, sheet = sheet_name, range = "A2:G2", col_names = FALSE)

# Combine the two rows to form the header
header <- paste(header_row1[1, ], header_row2[1, ], sep = "_")

# Read in the rest of the data
data <- read_excel(path_to_excel, sheet = sheet_name, skip = 2, col_names = FALSE)

# Assign the combined header to the data
colnames(data) <- header

CHR_OR_Out_Fact_Rank_2021 <- data

rm(data, header_row1, header_row2, header, sheet_name, path_to_excel)

```


### Import 2021 "Outcomes & Factors SubRankings"
```{r}
# Define the path to the Excel file
path_to_excel <- "~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx"

# Name of the sheet
sheet_name <- "Outcomes & Factors SubRankings"

# Read in the first row (0-indexed)
header_row1 <- read_excel(path_to_excel, sheet = sheet_name, range = "A1:O1", col_names = FALSE)

# Read in the second row
header_row2 <- read_excel(path_to_excel, sheet = sheet_name, range = "A2:O2", col_names = FALSE)

# Combine the two rows to form the header
header <- paste(header_row1[1, ], header_row2[1, ], sep = "_")

# Read in the rest of the data
data <- read_excel(path_to_excel, sheet = sheet_name, skip = 2, col_names = FALSE)

# Assign the combined header to the data
colnames(data) <- header

CHR_OR_Out_Fact_SubRank_2021 <- data

rm(data, header_row1, header_row2, header, sheet_name, path_to_excel)

```


### Import 2021 "Ranked Measure Data"
```{r}
# Define the path to the Excel file
path_to_excel <- "~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx"

# Name of the sheet
sheet_name <- "Ranked Measure Data"

# Read in the first row (0-indexed)
header_row1 <- read_excel(path_to_excel, sheet = sheet_name, range = "A1:FH1", col_names = FALSE)

# Read in the second row
header_row2 <- read_excel(path_to_excel, sheet = sheet_name, range = "A2:FH2", col_names = FALSE)

# Combine the two rows to form the header
header <- paste(header_row1[1, ], header_row2[1, ], sep = "_")

# Read in the rest of the data
data <- read_excel(path_to_excel, sheet = sheet_name, skip = 2, col_names = FALSE)

# Assign the combined header to the data
colnames(data) <- header

CHR_OR_Rank_Meas_Data_2021 <- data

rm(data, header_row1, header_row2, header, sheet_name, path_to_excel)

```


### Import 2021 "Additional Measure Data"
```{r}
# Define the path to the Excel file
path_to_excel <- "~/Schooling/Willamette-MSDS/2-DATA510_Capstone/MSDS-Capstone(not_repo'ed)/Country Health Rankings and Roadmaps/Oregon/2021 County Health Rankings Oregon Data - v1.xlsx"

# Name of the sheet
sheet_name <- "Additional Measure Data"

# Read in the first row (0-indexed)
header_row1 <- read_excel(path_to_excel, sheet = sheet_name, range = "A1:CU1", col_names = FALSE)

# Read in the second row
header_row2 <- read_excel(path_to_excel, sheet = sheet_name, range = "A2:CU2", col_names = FALSE)

# Combine the two rows to form the header
header <- paste(header_row1[1, ], header_row2[1, ], sep = "_")

# Read in the rest of the data
data <- read_excel(path_to_excel, sheet = sheet_name, skip = 2, col_names = FALSE)

# Assign the combined header to the data
colnames(data) <- header

CHR_OR_Add_Meas_Data_2021 <- data

rm(data, header_row1, header_row2, header, sheet_name, path_to_excel)

```

